set-option -g default-shell /bin/zsh

# prefix + C-l clears screen. Useful because I remapped C-l to move around panes
bind C-l send-keys 'C-l'

# Pro esc não ficar lerdo dentro do nvim dentro do tmux
# https://github.com/neovim/neovim/issues/2035
set -sg escape-time 10

# Dividir os painéis
unbind '"'
unbind %
bind s split-window -v -c "#{pane_current_path}"
bind v split-window -h -c "#{pane_current_path}"

# Histórico grandão
set -g history-limit 10000

# Atualizar o título do terminal dentro do Tmux
set -g set-titles on
set -g set-titles-string "#{window_name}" ##{pane_current_path} não atualiza enquanto eu mudo de diretório... ):<

# Começar uma janela nova no mesmo diretório
bind c new-window -c "#{pane_current_path}"

# Atalho para carregar as configurações
bind r source-file ~/.tmux.conf

############
# smart pane switching with awareness of vim splits
bind -n C-h run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys C-h) || tmux select-pane -L"
bind -n C-j run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys C-j) || tmux select-pane -D"
bind -n C-k run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys C-k) || tmux select-pane -U"
bind -n C-l run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys C-l) || tmux select-pane -R"
############

# Comandos mais fáceis para mudar os tamanhos dos painéis
unbind -n C-Left
unbind -n C-Right
unbind -n C-Up
unbind -n C-Down

bind -n S-Left resize-pane -L
bind -n S-Right resize-pane -R
bind -n S-Up resize-pane -U
bind -n S-Down resize-pane -D

bind -r C-Left resize-pane -L 5
bind -r C-Right resize-pane -R 5
bind -r C-Up resize-pane -U 5
bind -r C-Down resize-pane -D 5

# Não renomear as sessões automaticamente
set -g allow-rename off

### Seção de eu tentando deixar o tmux mais bonito ###
# Cores de verdade
set -g default-terminal "xterm-256color"

# Status bar lá embaixo
# set -g status-style 'bg=colour22'
# set -g status-style 'bg=#a02727'
set -g status-style 'bg=#606060 fg=#d6d6d6'
set -g window-status-current-style 'bg=terminal fg=terminal'
set -g message-style 'bg=#fcba03 fg=#000000'

set -g status-left " [#S] "
# [kirby] qui, 11/fev/21 - 16:34
set -g status-right "[#h] #(date '+%a, %d/%b/%y - %H:%M') "

# Experimentos...
# set -g status-right "#(cd #{pane_current_path}; git rev-parse --abbrev-ref HEAD) #(date '+%a, %d/%b/%y') @#h"
# git branch? https://koenwoortman.com/tmux-show-current-git-branch-in-status-bar/
# set -g status-right "#(cd #{pane_current_path}; git rev-parse --abbrev-ref HEAD)"

# Painéis
### Escurecer as janelas com exceção da atual, da um efeito de "janela em foco"
### e "janela sem foco"
# set -g pane-border-style 'fg=colour16 bg=#1c0615'
# set -g pane-active-border-style 'fg=colour22'
# set -g window-style 'bg=#1c0615 fg=#54444f'
# set -g window-active-style 'bg=terminal fg=terminal'
### Não tão escuro quanto a opção acima, e não muda as letras da janela sem foco
### era esse => set -g window-active-style 'bg=terminal fg=terminal'
# Roxo pro padrão ubuntu
# set -g window-style 'bg=#301424'
# set -g pane-border-style 'bg=#301424'
# Cinza mais escuro pro ayu-dark
### e esse => set -g window-style 'bg=#242A36'
# set -g pane-border-style 'bg=#181c25'

# Usar o mouse pra quê?
set -g mouse on

# Copiar do tmux pro clip board do sistema usando xclip?
# bind -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel "xclip -i -f -selection primary | xclip -i -selection clipboard"

# Vi mode no modo de copiar
# Algumas ideias vindas daqui, mas só algumas
# https://www.rockyourcode.com/copy-and-paste-in-tmux/
setw -g mode-keys vi
# v começa a selecionar
bind-key -T copy-mode-vi v send-keys -X begin-selection
# Control + v seleciona em blocos
bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle
# Pra copiar ainda é Enter e pra colar, prefixo + ]

unbind C-p

# https://superuser.com/questions/310251/use-terminal-scrollbar-with-tmux?lq=1
# set -ga terminal-overrides ',xterm*:smcup@:rmcup@'

bind-key -r b run-shell "tmux neww bash -c \"~/scripts/tmux-chtsh/tmux-cht.sh\""
